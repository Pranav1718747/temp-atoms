<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ClimateSync - Farmer Dashboard</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="farming.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script src="https://cdn.socket.io/4.7.1/socket.io.min.js"></script>
</head>
<body>
  <!-- Navigation -->
  <nav class="navigation">
    <div class="nav-container">
      <div class="nav-logo">
        <i class="fas fa-seedling"></i>
        <span>ClimateSync Farming</span>
      </div>
      <div class="nav-links">
        <a href="index.html" class="nav-link">
          <i class="fas fa-cloud-sun"></i>
          Weather Dashboard
        </a>
        <a href="farming.html" class="nav-link active">
          <i class="fas fa-tractor"></i>
          Farming Dashboard
        </a>
      </div>
    </div>
  </nav>

  <!-- Main Container -->
  <div class="container farming-container">
    <!-- Header Section -->
    <header class="farming-header">
      <div class="header-content">
        <div class="farming-title">
          <h1>ğŸŒ¾ Smart Farming Dashboard</h1>
          <p>Weather insights simplified for farmers</p>
        </div>
        <div class="season-indicator">
          <span class="season-icon">ğŸŒ±</span>
          <span class="season-text" id="currentSeason">Loading...</span>
        </div>
      </div>
    </header>

    <!-- Controls Section -->
    <section class="farming-controls">
      <div class="controls-grid">
        <div class="control-group location-search-group">
          <label>ğŸ“ Search Your Location</label>
          <div class="location-search-container">
            <div class="search-wrapper">
              <i class="fas fa-search search-icon"></i>
              <input type="text" id="locationSearch" class="location-search farming-search" placeholder="Search any city, village, or location worldwide..." autocomplete="off">
              <button id="searchBtn" class="search-btn farming-search-btn" onclick="searchLocation()">
                <i class="fas fa-globe"></i>
                <span>Search</span>
              </button>
            </div>
            <!-- Search Results Dropdown -->
            <div id="searchResults" class="search-results" style="display: none;"></div>
          </div>
        </div>
        <div class="control-group">
          <label for="cropSelect">ğŸŒ¾ Select Your Crop</label>
          <select id="cropSelect" class="farming-select">
            <option value="rice">Rice (à¤§à¤¾à¤¨)</option>
            <option value="wheat">Wheat (à¤—à¥‡à¤¹à¥‚à¤‚)</option>
            <option value="cotton">Cotton (à¤•à¤ªà¤¾à¤¸)</option>
            <option value="sugarcane">Sugarcane (à¤—à¤¨à¥à¤¨à¤¾)</option>
            <option value="tomato">Tomato (à¤Ÿà¤®à¤¾à¤Ÿà¤°)</option>
            <option value="onion">Onion (à¤ªà¥à¤¯à¤¾à¤œ)</option>
          </select>
        </div>
        <div class="control-group">
          <label for="stageSelect">ğŸŒ± Growth Stage</label>
          <select id="stageSelect" class="farming-select">
            <option value="seedling">Seedling (à¤¬à¥€à¤œ)</option>
            <option value="vegetative">Growing (à¤¬à¤¢à¤¼à¤¨à¤¾)</option>
            <option value="flowering">Flowering (à¤«à¥‚à¤²)</option>
            <option value="fruiting">Fruiting (à¤«à¤²)</option>
            <option value="harvest">Harvest (à¤•à¤Ÿà¤¾à¤ˆ)</option>
          </select>
        </div>
      </div>
    </section>

    <!-- Weather Summary for Farmers -->
    <section class="weather-summary">
      <div class="weather-cards">
        <div class="weather-card temperature-card">
          <div class="card-icon">ğŸŒ¡ï¸</div>
          <div class="card-content">
            <div class="card-value" id="temperature">--Â°C</div>
            <div class="card-label">Temperature</div>
            <div class="card-status" id="tempStatus">Checking...</div>
            <div class="visual-indicator">
              <div class="temperature-bar" id="tempBar">
                <div class="temp-fill" id="tempFill"></div>
                <div class="temp-marker ideal" id="tempIdeal">Ideal</div>
              </div>
            </div>
          </div>
        </div>
        <div class="weather-card humidity-card">
          <div class="card-icon">ğŸ’§</div>
          <div class="card-content">
            <div class="card-value" id="humidity">--%</div>
            <div class="card-label">Humidity</div>
            <div class="card-status" id="humidityStatus">Checking...</div>
            <div class="visual-indicator">
              <div class="humidity-circle" id="humidityCircle">
                <svg width="80" height="80">
                  <circle cx="40" cy="40" r="35" fill="none" stroke="#e0e0e0" stroke-width="6"/>
                  <circle cx="40" cy="40" r="35" fill="none" stroke="#2196f3" stroke-width="6" 
                          stroke-dasharray="220" stroke-dashoffset="220" id="humidityProgress"
                          transform="rotate(-90 40 40)"/>
                </svg>
                <div class="circle-text" id="humidityText">0%</div>
              </div>
            </div>
          </div>
        </div>
        <div class="weather-card rainfall-card">
          <div class="card-icon">ğŸŒ§ï¸</div>
          <div class="card-content">
            <div class="card-value" id="rainfall">-- mm</div>
            <div class="card-label">Rainfall</div>
            <div class="card-status" id="rainfallStatus">Checking...</div>
            <div class="visual-indicator">
              <div class="rainfall-animation" id="rainfallAnimation">
                <div class="rain-container">
                  <div class="raindrop"></div>
                  <div class="raindrop"></div>
                  <div class="raindrop"></div>
                  <div class="raindrop"></div>
                  <div class="raindrop"></div>
                </div>
                <div class="water-level" id="waterLevel">
                  <div class="water-fill" id="waterFill"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Enhanced Weather Information Grid -->
    <section class="enhanced-weather-section">
      <h2>ğŸŒ¤ï¸ Comprehensive Weather Information</h2>
      
      <div class="enhanced-weather-grid">
        <!-- Atmospheric Pressure -->
        <div class="enhanced-weather-card">
          <div class="weather-card-header">
            <div class="weather-card-icon" style="background: linear-gradient(135deg, #2196f3, #1976d2);">ğŸŒ¡ï¸</div>
            <h3 class="weather-card-title">Atmospheric Pressure</h3>
          </div>
          <div class="pressure-gauge">
            <svg viewBox="0 0 100 100">
              <circle cx="50" cy="50" r="40" class="gauge-bg"></circle>
              <circle cx="50" cy="50" r="40" class="gauge-fill" id="pressureGauge"
                      stroke-dasharray="0 251" stroke-dashoffset="0"></circle>
            </svg>
            <div class="pressure-value">
              <div class="value" id="pressureValue">--</div>
              <div class="unit">hPa</div>
            </div>
          </div>
          <div class="pressure-trend" id="pressureTrend">
            <span id="pressureTrendIcon">ğŸ“Š</span>
            <span id="pressureTrendText">Checking...</span>
          </div>
        </div>

        <!-- Wind Information with Compass -->
        <div class="enhanced-weather-card">
          <div class="weather-card-header">
            <div class="weather-card-icon" style="background: linear-gradient(135deg, #00bcd4, #0097a7);">ğŸ’¨</div>
            <h3 class="weather-card-title">Wind Conditions</h3>
          </div>
          <div class="wind-compass" id="windCompass">
            <div class="compass-directions">
              <span class="north">N</span>
              <span class="east">E</span>
              <span class="south">S</span>
              <span class="west">W</span>
            </div>
            <div class="wind-arrow" id="windArrow"></div>
          </div>
          <div class="wind-info">
            <div class="wind-speed" id="windSpeed">-- km/h</div>
            <div class="wind-direction" id="windDirectionText">--</div>
          </div>
        </div>

        <!-- UV Index Meter -->
        <div class="enhanced-weather-card">
          <div class="weather-card-header">
            <div class="weather-card-icon" style="background: linear-gradient(135deg, #ff9800, #f57c00);">â˜€ï¸</div>
            <h3 class="weather-card-title">UV Index</h3>
          </div>
          <div class="uv-meter">
            <div class="uv-value" id="uvValue">--</div>
            <div class="uv-scale">
              <div class="uv-indicator" id="uvIndicator"></div>
            </div>
            <div class="uv-level" id="uvLevel">Checking...</div>
          </div>
        </div>

        <!-- Air Quality Index -->
        <div class="enhanced-weather-card">
          <div class="weather-card-header">
            <div class="weather-card-icon" style="background: linear-gradient(135deg, #9c27b0, #7b1fa2);">ğŸŒ«ï¸</div>
            <h3 class="weather-card-title">Air Quality</h3>
          </div>
          <div class="air-quality-indicator">
            <div class="aqi-circle">
              <svg viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="35" class="aqi-bg"></circle>
                <circle cx="50" cy="50" r="35" class="aqi-fill" id="aqiCircle"
                        stroke-dasharray="0 220" stroke-dashoffset="0"></circle>
              </svg>
              <div class="aqi-value">
                <div class="value" id="aqiValue">--</div>
                <div class="label">AQI</div>
              </div>
            </div>
            <div class="aqi-status" id="aqiStatus">Checking...</div>
          </div>
        </div>

        <!-- Soil Conditions -->
        <div class="enhanced-weather-card">
          <div class="weather-card-header">
            <div class="weather-card-icon" style="background: linear-gradient(135deg, #795548, #5d4037);">ğŸŒ±</div>
            <h3 class="weather-card-title">Soil Conditions</h3>
          </div>
          <div class="soil-conditions">
            <div class="soil-metric">
              <div class="label">Temperature</div>
              <div class="value" id="soilTemp">--</div>
              <div class="unit">Â°C</div>
              <div class="soil-temp-bar">
                <div class="soil-temp-fill" id="soilTempBar"></div>
              </div>
            </div>
            <div class="soil-metric">
              <div class="label">Moisture</div>
              <div class="value" id="soilMoisture">--</div>
              <div class="unit">%</div>
              <div class="soil-moisture-circle">
                <svg viewBox="0 0 60 60">
                  <circle cx="30" cy="30" r="25" class="moisture-bg"></circle>
                  <circle cx="30" cy="30" r="25" class="moisture-fill" id="soilMoistureCircle"
                          stroke-dasharray="0 157" stroke-dashoffset="0"></circle>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <!-- Growing Degree Days -->
        <div class="enhanced-weather-card">
          <div class="weather-card-header">
            <div class="weather-card-icon" style="background: linear-gradient(135deg, #7cb342, #558b2f);">ğŸ“ˆ</div>
            <h3 class="weather-card-title">Growing Degree Days</h3>
          </div>
          <div class="gdd-display">
            <div class="gdd-value" id="gddValue">--</div>
            <div class="gdd-label">Today's GDD</div>
            <div class="gdd-progress">
              <div class="gdd-progress-fill" id="gddProgress"></div>
            </div>
          </div>
        </div>

        <!-- Heat Index -->
        <div class="enhanced-weather-card">
          <div class="weather-card-header">
            <div class="weather-card-icon" style="background: linear-gradient(135deg, #f44336, #d32f2f);">ğŸ”¥</div>
            <h3 class="weather-card-title">Heat Index</h3>
          </div>
          <div class="heat-index-display">
            <div class="heat-index-value" id="heatIndexValue">--Â°C</div>
            <div class="heat-index-level" id="heatIndexLevel">Checking...</div>
          </div>
        </div>

        <!-- Moon Phase -->
        <div class="enhanced-weather-card">
          <div class="weather-card-header">
            <div class="weather-card-icon" style="background: linear-gradient(135deg, #607d8b, #455a64);">ğŸŒ™</div>
            <h3 class="weather-card-title">Moon Phase</h3>
          </div>
          <div class="moon-phase-display">
            <span class="moon-icon" id="moonIcon">ğŸŒ™</span>
            <div class="moon-phase-name" id="moonPhaseName">--</div>
            <div class="moon-illumination" id="moonIllumination">-- % visible</div>
          </div>
        </div>
      </div>
    </section>
      
      <!-- Weather Chart -->
      <div class="weather-chart-container">
        <div class="chart-card">
          <h3>ğŸ“Š Daily Weather Pattern</h3>
          <div class="chart-area" id="weatherChart">
            <canvas id="weatherCanvas" width="400" height="200"></canvas>
          </div>
        </div>
      </div>

      <!-- Comprehensive Weather Scene -->
      <div class="comprehensive-weather-scene">
        <!-- Main Weather Scene -->
        <div class="main-weather-scene">
          <div class="scene-container" id="weatherScene">
            <div class="sun" id="sunElement"></div>
            <div class="clouds" id="cloudsElement">
              <div class="cloud cloud1"></div>
              <div class="cloud cloud2"></div>
            </div>
            <div class="precipitation" id="precipitationElement">
              <!-- Dynamic precipitation will be added here -->
            </div>
            <div class="weather-overlay-info">
              <div class="scene-temp" id="sceneTemp">--Â°C</div>
              <div class="scene-condition" id="sceneCondition">Loading...</div>
            </div>
            <div class="ground">
              <!-- Ground with CSS grass effect -->
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Farming Recommendations -->
    <section class="recommendations-section">
      <h2>ğŸ¯ Smart Recommendations for You</h2>
      
      <!-- Overall Condition -->
      <div class="overall-condition" id="overallCondition">
        <div class="condition-icon">â³</div>
        <div class="condition-text">
          <h3>Loading your farming conditions...</h3>
          <p>Please wait while we analyze the weather</p>
        </div>
      </div>

      <!-- Recommendation Cards -->
      <div class="recommendation-grid" id="recommendationGrid">
        <!-- Dynamic content will be inserted here -->
      </div>
    </section>

    <!-- Irrigation Advice -->
    <section class="irrigation-section">
      <h2>ğŸ’§ Water Management</h2>
      <div class="irrigation-card" id="irrigationCard">
        <div class="irrigation-icon">ğŸ’¦</div>
        <div class="irrigation-content">
          <h3>Loading irrigation advice...</h3>
          <p>Calculating water requirements...</p>
        </div>
      </div>
    </section>

    <!-- Suitable Crops -->
    <section class="suitable-crops-section">
      <div class="ml-header">
        <h2>ğŸŒ¾ AI Crop Recommendations</h2>
        <div class="recommendation-buttons">
          <button id="generateCropRecommendations" class="predict-btn" onclick="loadCropRecommendations()">
            <i class="fas fa-brain"></i> Get AI Recommendations
          </button>
          <button id="generateEnhancedRecommendations" class="predict-btn enhanced-btn" onclick="loadEnhancedCropRecommendations()">
            <i class="fas fa-chart-line"></i> Enhanced with Real Data
          </button>
        </div>
      </div>
      <div class="crops-grid" id="cropsGrid">
        <!-- Dynamic content will be inserted here -->
      </div>
    </section>

    <!-- AI Agents Analysis -->
    <section class="ai-analysis-section">
      <div class="ai-header">
        <h2>ğŸ¤– AI Farming Agents</h2>
        <div class="ai-controls">
          <div class="farm-size-input">
            <label for="farmSizeInput">Farm Size (hectares):</label>
            <input type="number" id="farmSizeInput" value="1" min="0.1" max="1000" step="0.1" class="farming-input">
          </div>
          <button id="runAIAnalysis" class="ai-analysis-btn" onclick="loadAIAnalysis()">
            <i class="fas fa-robot"></i> Run AI Analysis
          </button>
        </div>
      </div>
      <div class="ai-description">
        <p>ğŸ§  Our AI agents analyze weather patterns, market trends, resource optimization, and risk factors to provide you with comprehensive farming insights.</p>
      </div>
      <div class="ai-analysis-container" id="aiAnalysisContainer">
        <div class="ai-placeholder">
          <div class="ai-placeholder-icon">ğŸ¤–</div>
          <h3>AI Analysis Ready</h3>
          <p>Click "Run AI Analysis" to get comprehensive insights from our farming AI agents including:</p>
          <ul>
            <li>ğŸŒ± <strong>Crop Advisory Agent</strong> - Personalized crop recommendations</li>
            <li>ğŸŒ¤ï¸ <strong>Weather Prediction Agent</strong> - Advanced weather analysis</li>
            <li>ğŸ’° <strong>Market Intelligence Agent</strong> - Price trends and market insights</li>
            <li>ğŸ’§ <strong>Resource Optimization Agent</strong> - Water and fertilizer optimization</li>
            <li>âš ï¸ <strong>Risk Assessment Agent</strong> - Pest, disease, and climate risk analysis</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Farming Alerts -->
    <section class="farming-alerts-section">
      <h2>âš ï¸ Important Farming Alerts</h2>
      <div class="alerts-container" id="farmingAlerts">
        <!-- Dynamic alerts will be inserted here -->
      </div>
    </section>

    <!-- Quick Actions -->
    <section class="quick-actions">
      <h2>ğŸš€ Quick Actions</h2>
      <div class="actions-grid">
        <button class="action-btn" onclick="refreshFarmingData()">
          <i class="fas fa-sync-alt"></i>
          <span>Refresh Data</span>
        </button>
        <button class="action-btn" onclick="showWeatherForecast()">
          <i class="fas fa-calendar-week"></i>
          <span>7-Day Forecast</span>
        </button>
        <button class="action-btn" onclick="showCropCalendar()">
          <i class="fas fa-calendar-alt"></i>
          <span>Crop Calendar</span>
        </button>
        <button class="action-btn" onclick="showExpertTips()">
          <i class="fas fa-lightbulb"></i>
          <span>Expert Tips</span>
        </button>
        <button class="action-btn" onclick="testComprehensiveWeatherManual()" style="background: #ff4444; color: white;">
          <i class="fas fa-bug"></i>
          <span>TEST Weather</span>
        </button>
        <button class="action-btn" onclick="manualTestDashboard()" style="background: #4444ff; color: white;">
          <i class="fas fa-cog"></i>
          <span>TEST Dashboard</span>
        </button>
        <button class="action-btn" onclick="forceUpdateDashboard()" style="background: #9c27b0; color: white;">
          <i class="fas fa-bolt"></i>
          <span>FORCE Update</span>
        </button>
      </div>
    </section>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner">
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
    </div>
    <p class="loading-text">Loading farming insights...</p>
  </div>

  <!-- Modals -->
  <div class="modal" id="forecastModal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('forecastModal')">&times;</span>
      <h2>7-Day Weather Forecast</h2>
      <div id="forecastContent">Coming soon...</div>
    </div>
  </div>

  <div class="modal" id="calendarModal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('calendarModal')">&times;</span>
      <h2>Seasonal Crop Calendar</h2>
      <div id="calendarContent">Loading calendar...</div>
    </div>
  </div>

  <script src="farming.js"></script>
</body>
</html>